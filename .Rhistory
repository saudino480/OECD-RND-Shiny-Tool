filter(MSTI_VAR == "VA_XGDP") %>%
group_by(MSTI_VAR) %>%
summarise_at(temp_countries, max)
max <- data %>%
filter(MSTI_VAR == "VA_XGDP") %>%
summarise_at(temp_countries, max)
max_asda <- data %>%
filter(MSTI_VAR == "VA_XGDP") %>%
summarise_at(temp_countries, max)
maxasda <- data %>%
filter(MSTI_VAR == "VA_XGDP") %>%
summarise_at(temp_countries, max)
max(temp_df[temp_countries], na.rm=TRUE)
temp_df = data %>%
filter(MSTI_VAR == "VA_XGDP") %>%
group_by(MSTI_VAR) %>%
summarise_at(temp_countries, netPercent)
max_df = data %>%
filter(MSTI_VAR == "VA_XGDP") %>%
group_by(MSTI_VAR) %>%
summarise_at(temp_countries, max, na.rm=T)
?max
runApp()
runApp()
max_df = data %>%
filter(MSTI_VAR == "VA_XGDP") %>%
group_by(MSTI_VAR) %>%
summarise_at(temp_countries, max, na.rm=TRUE)
temp_countries = colnames(data)[!(colnames(data) %in% data_labels)]
max_df = data %>%
filter(MSTI_VAR == "VA_XGDP") %>%
group_by(MSTI_VAR) %>%
summarise_at(temp_countries, max, na.rm=TRUE)
View(max_df)
max_df = data %>%
filter(MSTI_VAR == "VA_XGDP") %>%
group_by(MSTI_VAR) %>%
summarise_at(temp_countries, max, na.rm=TRUE) %>%
maxColName(temp_countries)
max_df = data %>%
filter(MSTI_VAR == "VA_XGDP") %>%
group_by(MSTI_VAR) %>%
summarise_at(temp_countries, max, na.rm=TRUE) %>%
unlist(maxColName(temp_countries))
max_df = data %>%
filter(MSTI_VAR == "VA_XGDP") %>%
group_by(MSTI_VAR) %>%
summarise_at(temp_countries, max, na.rm=TRUE) %>%
maxColName(temp_countries) %>%
unlist()
max_raw = data %>%
filter(MSTI_VAR == "VA_XGDP") %>%
group_by(MSTI_VAR) %>%
summarise_at(temp_countries, max, na.rm=TRUE) %>%
maxColValue(temp_countries) %>%
unlist()
?filter_at
typeof(max_raw)
max_raw_df = data %>%
group_by(MSTI_VAR) %>%
summarise_at(temp_countries, max, na.rm=TRUE)
View(max_raw_df)
max_raw_df = data %>%
filter(MSTI_VAR == "VA_XGDP") %>%
group_by(MSTI_VAR) %>%
summarise_at(temp_countries, max, na.rm=TRUE)
max_raw_year = data %>%
filter(MSTI_VAR == "VA_XGDP") %>%
filter_at(vars(temp_countries), any_vars(. == max_raw_value))
max_raw_value = maxColValue(temp_df, temp_countries)
temp_df = data %>%
filter(MSTI_VAR == "VA_XGDP") %>%
group_by(MSTI_VAR) %>%
summarise_at(temp_countries, netPercent)
max_raw_df = data %>%
filter(MSTI_VAR == "VA_XGDP") %>%
group_by(MSTI_VAR) %>%
summarise_at(temp_countries, max, na.rm=TRUE)
min_raw_df = data %>%
group_by(MSTI_VAR) %>%
summarise_at(temp_countries, max, na.rm=TRUE)
max_raw_value = maxColValue(temp_df, temp_countries)
max_raw_year = data %>%
filter(MSTI_VAR == "VA_XGDP") %>%
filter_at(vars(temp_countries), any_vars(. == max_raw_value))
View(max_raw_df)
max_raw_value = maxColValue(temp_df, temp_countries)
max_raw_year = data %>%
filter(MSTI_VAR == "VA_XGDP") %>%
filter_at(vars(temp_countries), any_vars(. == max_raw))
View(temp_df)
max_raw_year = data %>%
filter(MSTI_VAR == "VA_XGDP") %>%
filter_at(vars(temp_countries), any_vars(. == max_raw_value))
View(max_raw_df)
max_raw_year = data %>%
filter(MSTI_VAR == "VA_XGDP") %>%
filter_at(vars(temp_countries), any_vars(. %in%  max_raw_value))
View(max_raw_year)
temp_df = data %>%
filter(MSTI_VAR == "VA_XGDP") %>%
group_by(MSTI_VAR) %>%
summarise_at(temp_countries, netPercent)
max_raw_value = maxColValue(temp_df, temp_countries)
max_raw_year = data %>%
filter(MSTI_VAR == "VA_XGDP") %>%
filter_at(vars(temp_countries), any_vars(. %in%  max_raw_value))
max_raw_value = maxColValue(max_raw_df, temp_countries)
max_raw_year = data %>%
filter(MSTI_VAR == "VA_XGDP") %>%
filter_at(temp_countries %in% max_raw_value))
max_raw_year = data %>%
filter(MSTI_VAR == "VA_XGDP") %>%
filter_at(temp_countries %in% max_raw_value)
max_raw_year = data %>%
filter(MSTI_VAR == "VA_XGDP") %>%
filter_at(vars(temp_countries), any_vars(. %in% max_raw_value))
max_raw_year = data %>%
filter(MSTI_VAR == "VA_XGDP") %>%
filter_at(vars(temp_countries), any_vars(. %in% max_raw_value)) %>%
select(YEAR) %>%
unlist()
testing_data = data %>%
filter(MSTI_VAR == "VA_XGDP")
View(testing_data)
temp_countries = colnames(testing_data)[!(colnames(testing_data) %in% data_labels)]
max_raw_df = testing_data %>%
group_by(MSTI_VAR) %>%
summarise_at(temp_countries, max, na.rm=TRUE)
min_raw_df = testing_data %>%
group_by(MSTI_VAR) %>%
summarise_at(temp_countries, min, na.rm=TRUE)
pc_df = testing_data %>%
group_by(MSTI_VAR) %>%
summarise_at(temp_countries, netPercent)
#### raw values ####
max_raw_value = max_raw_df %>%
maxColValue(temp_countries) %>%
unlist()
max_raw_name = max_raw_df %>%
maxColName(temp_countries) %>%
unlist()
max_raw_year = testing_data %>%
filter_at(vars(temp_countries), any_vars(. %in% max_raw_value)) %>%
select(YEAR) %>%
unlist()
min_raw_value = min_raw_df %>%
minColValue(temp_countries) %>%
unlist()
min_raw_name = min_raw_df %>%
minColName(temp_countries) %>%
unlist()
min_raw_year = testing_data %>%
filter_at(vars(temp_countries), any_vars(. %in% min_raw_value)) %>%
select(YEAR) %>%
unlist()
raw_info = data.frame(raw_minumum = list(max_raw_year, max_raw_name, max_raw_value),
raw_maximum = list(min_raw_year, min_raw_name, min_raw_value))
View(raw_info)
raw_info = data.frame(raw_type = c("Max", "Min")
raw_name = list(max_raw_name, min_raw_value),
raw_value = c(max_raw_value, min_raw_value),
raw_year = c(max_raw_year, min_raw_year))
raw_info = data.frame(raw_type = c("Max", "Min"),
raw_name = list(max_raw_name, min_raw_value),
raw_value = c(max_raw_value, min_raw_value),
raw_year = c(max_raw_year, min_raw_year))
raw_info = data.frame(raw_type = c("Max", "Min"),
raw_name = c(max_raw_name, min_raw_value),
raw_value = c(max_raw_value, min_raw_value),
raw_year = c(max_raw_year, min_raw_year))
raw_info = data.frame(raw_type = c("Max", "Min"),
raw_name = c(max_raw_name, min_raw_name),
raw_value = c(max_raw_value, min_raw_value),
raw_year = c(max_raw_year, min_raw_year))
#### pc values #####
max_pc_value = pc_df %>%
maxColValue(temp_countries) %>%
unlist()
max_pc_name = pc_df %>%
maxColName(temp_countries) %>%
unlist()
min_pc_value = pc_df %>%
minColValue(temp_countries) %>%
unlist()
min_pc_name = pc_df %>%
minColName(temp_countries) %>%
unlist()
pc_info = data.frame(type = c("Max_PC", "Min_PC"),
name = c(max_pc_name, min_pc_name),
value = c(max_pc_value, min_pc_value)
)
pc_info = data.frame(type = c("Max_PC", "Min_PC"),
name = c(max_pc_name, min_pc_name),
value = c(max_pc_value, min_pc_value)
year = c(0, 0))
pc_info = data.frame(type = c("Max_PC", "Min_PC"),
name = c(max_pc_name, min_pc_name),
value = c(max_pc_value, min_pc_value),
year = c(0, 0))
does_it_work = rbind(raw_info, pc_info)
View(pc_info)
View(raw_info)
raw_info = data.frame(type = c("Max_Raw", "Min_Raw"),
name = c(max_raw_name, min_raw_name),
value = c(max_raw_value, min_raw_value),
year = c(max_raw_year, min_raw_year))
View(raw_info)
pc_info = data.frame(type = c("Max_PC", "Min_PC"),
name = c(max_pc_name, min_pc_name),
value = c(max_pc_value, min_pc_value),
year = c(0, 0))
does_it_work = rbind(raw_info, pc_info)
View(does_it_work)
runApp()
?infoBox
does_it_work$value[1]
runApp()
is.na(notanobject)
exists(notanobject)
runApp()
runApp()
runApp()
runApp()
runApp()
?renderInfoBox
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
minColName = function(df, cols) {
return(colnames(df[cols])[which.min(apply(df[cols], MARGIN = 2, min))])
}
runApp()
runApp()
max_raw_df = testing_data %>%
group_by(MSTI_VAR) %>%
summarise_at(temp_countries, max, na.rm=TRUE)
min_raw_df = testing_data %>%
group_by(MSTI_VAR) %>%
summarise_at(temp_countries, min, na.rm=TRUE)
pc_df = testing_data %>%
group_by(MSTI_VAR) %>%
summarise_at(temp_countries, netPercent)
runApp()
testing_data = data %>%
filter(MSTI_VAR == "VA_XGDP")
temp_countries = colnames(testing_data)[!(colnames(testing_data) %in% data_labels)]
max_raw_df = testing_data %>%
group_by(MSTI_VAR) %>%
summarise_at(temp_countries, max, na.rm=TRUE)
min_raw_df = testing_data %>%
group_by(MSTI_VAR) %>%
summarise_at(temp_countries, min, na.rm=TRUE)
pc_df = testing_data %>%
group_by(MSTI_VAR) %>%
summarise_at(temp_countries, netPercent)
#### raw values ####
max_raw_value = max_raw_df %>%
maxColValue(temp_countries) %>%
unlist()
max_raw_name = max_raw_df %>%
maxColName(temp_countries) %>%
unlist()
max_raw_year = testing_data %>%
filter_at(vars(temp_countries), any_vars(. %in% max_raw_value)) %>%
select(YEAR) %>%
unlist()
min_raw_value = min_raw_df %>%
minColValue(temp_countries) %>%
unlist()
min_raw_name = min_raw_df %>%
minColName(temp_countries) %>%
unlist()
min_raw_year = testing_data %>%
filter_at(vars(temp_countries), any_vars(. %in% min_raw_value)) %>%
select(YEAR) %>%
unlist()
raw_info = data.frame(type = c("Max_Raw", "Min_Raw"),
name = c(max_raw_name, min_raw_name),
value = c(max_raw_value, min_raw_value),
year = c(max_raw_year, min_raw_year))
#### pc values #####
max_pc_value = pc_df %>%
maxColValue(temp_countries) %>%
unlist()
#### pc values #####
max_pc_value = pc_df %>%
maxColValue(temp_countries) %>%
unlist()
max_pc_name = pc_df %>%
maxColName(temp_countries) %>%
unlist()
min_pc_value = pc_df %>%
minColValue(temp_countries) %>%
unlist()
min_pc_name = pc_df %>%
minColName(temp_countries) %>%
unlist()
pc_info = data.frame(type = c("Max_PC", "Min_PC"),
name = c(max_pc_name, min_pc_name),
value = c(max_pc_value, min_pc_value),
year = c(0, 0))
runApp()
runApp()
runApp()
?is.na
runApp()
pc_df = testing_data %>%
group_by(MSTI_VAR) %>%
summarise_at(temp_countries, netPercent) %>%
select_if(~ !any(is.na(.)))
View(pc_df)
pc_df$MSTI_VAR = NA
pc_df = pc_df %>%
select_if(~ !any(is.na(.)))
runApp()
View(data)
View(pc_info)
runApp()
View(pc_df)
runApp()
runApp()
runApp()
View(pc_info)
runApp()
runApp()
?infoBox
?fluidRow
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
data = read.csv(file = "../Science_Math_Spending.csv")
data1 = spread(data, key = unique(Country), value = Value)
names = colnames(data1)[14:59]
View(data1)
library(tidyverse)
data = read.csv(file = "../Science_Math_Spending.csv")
data1 = spread(data, key = unique(Country), value = Value)
names = colnames(data1)[14:59]
names[40:46]
data2 = data1 %>%
group_by(YEAR, MSTI_VAR, MSTI.Variables, Unit, PowerCode, COU) %>%
summarise_at(names, sum)
data3 = data2 %>%
group_by(YEAR, MSTI_VAR, MSTI.Variables, Unit, PowerCode) %>%
summarise_at(names, naSum, na.rm=TRUE)
countries = label_extractor(colnames(data3),
(c(22, 51, 21, 28, 42, 47, 35, 52, 13, 29, 30, 34, 11, 19, 20)-1))
data_labels = label_extractor(colnames(data3), 1:5)
data3 = data3 %>%
select(data_labels, countries)
data3$PowerCode[data3$Unit == ""] = "Millions"
data3$Unit[data3$Unit == ""] = "US Dollar"
temp_1 = data3 %>%
filter(MSTI_VAR == "VA_PPP" & YEAR != 2018)
temp_2 = data3 %>%
filter(MSTI_VAR == "GDP_PPP" & YEAR != 2018)
temp = test_1
temp[countries] = temp_1[countries] / temp_2[countries]
temp$MSTI_VAR = as.factor("VA_XGDP")
temp$MSTI.Variables = as.factor("Value Added of Industry as a percent of GDP (current PPP$)")
temp$Unit = as.factor("Percentage")
temp$PowerCode = as.factor("Units")
data3 = rbind(data3, temp)
data3$YEAR = as.numeric(data3$YEAR)
data3$MSTI_VAR = as.factor(data3$MSTI_VAR)
data3$MSTI.Variables = as.factor(data3$MSTI.Variables)
data3$Unit = as.factor(data3$Unit)
data3$PowerCode = as.factor(data3$PowerCode)
write.csv(data3, file = "./data/Science_Math_Eigth_Clean.csv")
print(colnames(data3))
runApp()
View(debugSum)
data2 = data1 %>%
group_by(YEAR, MSTI_VAR, MSTI.Variables, Unit, PowerCode, COU) %>%
summarise_at(names, sum)
data3 = data2 %>%
group_by(YEAR, MSTI_VAR, MSTI.Variables, Unit, PowerCode) %>%
summarise_at(names, naSum, na.rm=TRUE)
data = read.csv(file = "../Science_Math_Spending.csv")
data1 = spread(data, key = unique(Country), value = Value)
names = colnames(data1)[14:59]
data2 = data1 %>%
group_by(YEAR, MSTI_VAR, MSTI.Variables, Unit, PowerCode, COU) %>%
summarise_at(names, sum)
data3 = data2 %>%
group_by(YEAR, MSTI_VAR, MSTI.Variables, Unit, PowerCode) %>%
summarise_at(names, naSum, na.rm=TRUE)
View(data3)
data = read.csv(file = "../Science_Math_Spending.csv")
data1 = spread(data, key = unique(Country), value = Value)
names = colnames(data1)[14:59]
names[40:46]
data2 = data1 %>%
group_by(YEAR, MSTI_VAR, MSTI.Variables, Unit, PowerCode, COU) %>%
summarise_at(names, sum)
data3 = data2 %>%
group_by(YEAR, MSTI_VAR, MSTI.Variables, Unit, PowerCode) %>%
summarise_at(names, naSum, na.rm=TRUE)
countries = label_extractor(colnames(data3),
(c(22, 51, 21, 28, 42, 47, 27, 52, 13, 29, 30, 34, 11, 19, 20)-1))
data_labels = label_extractor(colnames(data3), 1:5)
data3 = data3 %>%
select(data_labels, countries)
data3$PowerCode[data3$Unit == ""] = "Millions"
data3$Unit[data3$Unit == ""] = "US Dollar"
temp_1 = data3 %>%
filter(MSTI_VAR == "VA_PPP" & YEAR != 2018)
temp_2 = data3 %>%
filter(MSTI_VAR == "GDP_PPP" & YEAR != 2018)
temp = test_1
temp[countries] = temp_1[countries] / temp_2[countries]
temp$MSTI_VAR = as.factor("VA_XGDP")
temp$MSTI.Variables = as.factor("Value Added of Industry as a percent of GDP (current PPP$)")
temp$Unit = as.factor("Percentage")
temp$PowerCode = as.factor("Units")
data3 = rbind(data3, temp)
data3$YEAR = as.numeric(data3$YEAR)
data3$MSTI_VAR = as.factor(data3$MSTI_VAR)
data3$MSTI.Variables = as.factor(data3$MSTI.Variables)
data3$Unit = as.factor(data3$Unit)
data3$PowerCode = as.factor(data3$PowerCode)
write.csv(data3, file = "./data/Science_Math_Eigth_Clean.csv")
View(data3)
runApp()
library(tidyverse)
data = read.csv(file = "../Science_Math_Spending.csv")
data1 = spread(data, key = unique(Country), value = Value)
names = colnames(data1)[14:59]
names[40:46]
data2 = data1 %>%
group_by(YEAR, MSTI_VAR, MSTI.Variables, Unit, PowerCode, COU) %>%
summarise_at(names, sum)
data3 = data2 %>%
group_by(YEAR, MSTI_VAR, MSTI.Variables, Unit, PowerCode) %>%
summarise_at(names, naSum, na.rm=TRUE)
countries = label_extractor(colnames(data3),
(c(22, 51, 21, 28, 42, 47, 27, 52, 13, 29, 30, 34, 11, 19, 20)-1))
data_labels = label_extractor(colnames(data3), 1:5)
data3 = data3 %>%
select(data_labels, countries)
data3$PowerCode[data3$Unit == ""] = "Millions"
data3$Unit[data3$Unit == ""] = "US Dollar"
temp_1 = data3 %>%
filter(MSTI_VAR == "VA_PPP" & YEAR != 2018)
temp_2 = data3 %>%
filter(MSTI_VAR == "GDP_PPP" & YEAR != 2018)
temp = test_1
temp[countries] = temp_1[countries] / temp_2[countries]
temp_1 = data3 %>%
filter(MSTI_VAR == "VA_PPP" & YEAR != 2018)
temp_2 = data3 %>%
filter(MSTI_VAR == "GDP_PPP" & YEAR != 2018)
temp = temp_1
temp[countries] = temp_1[countries] / temp_2[countries]
temp$MSTI_VAR = as.factor("VA_XGDP")
temp$MSTI.Variables = as.factor("Value Added of Industry as a percent of GDP (current PPP$)")
temp$Unit = as.factor("Percentage")
temp$PowerCode = as.factor("Units")
data3 = rbind(data3, temp)
data3$YEAR = as.numeric(data3$YEAR)
data3$MSTI_VAR = as.factor(data3$MSTI_VAR)
data3$MSTI.Variables = as.factor(data3$MSTI.Variables)
data3$Unit = as.factor(data3$Unit)
data3$PowerCode = as.factor(data3$PowerCode)
write.csv(data3, file = "./data/Science_Math_Eigth_Clean.csv")
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
?a
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
